### YamlMime:RESTOperation
summary: Creates or updates a managed cluster. Creates or updates a managed cluster with the specified configuration for agents and Kubernetes version.
service: AKS
apiVersion: 2017-08-31
groupName: Managed Clusters
consumes:
- application/json
produces:
- application/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ContainerService/managedClusters/{resourceName}?api-version=2017-08-31
uriParameters:
- in: path
  isRequired: true
  description: Subscription credentials which uniquely identify Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.
  types:
  - uid: string
  name: subscriptionId
- in: path
  isRequired: true
  description: The name of the resource group.
  types:
  - uid: string
  name: resourceGroupName
- in: path
  isRequired: true
  description: The name of the managed cluster resource.
  types:
  - uid: string
  name: resourceName
- in: query
  isRequired: true
  description: Client Api Version.
  types:
  - uid: string
  name: api-version
responses:
- description: OK
  types:
  - uid: ManagedCluster
  name: 200 OK
- description: Created
  types:
  - uid: ManagedCluster
  name: 201 Created
requestBody:
- parameters:
  - in: body
    isRequired: true
    description: Resource location
    types:
    - uid: string
    name: location
  - in: body
    description: Resource tags
    types:
    - isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
      uid: object
    name: tags
  - in: body
    description: Properties of a managed cluster.
    types:
    - uid: ManagedClusterProperties
    name: properties
requestHeader: []
definitions:
- name: ManagedClusterProperties
  description: Properties of the managed cluster.
  kind: object
  properties:
  - isReadyOnly: true
    description: The current deployment or provisioning state, which only appears in the response.
    types:
    - uid: string
    name: provisioningState
  - description: DNS prefix specified when creating the managed cluster.
    types:
    - uid: string
    name: dnsPrefix
  - isReadyOnly: true
    description: FDQN for the master pool.
    types:
    - uid: string
    name: fqdn
  - description: Version of Kubernetes specified when creating the managed cluster.
    types:
    - uid: string
    name: kubernetesVersion
  - description: Access profiles for the managed cluster.
    types:
    - uid: AccessProfiles
    name: accessProfiles
  - description: Properties of the agent pool.
    types:
    - uid: ContainerServiceAgentPoolProfile
    name: agentPoolProfiles
  - description: Profile for Linux VMs in the container service cluster.
    types:
    - uid: ContainerServiceLinuxProfile
    name: linuxProfile
  - description: Information about a service principal identity for the cluster to use for manipulating Azure APIs. Either secret or keyVaultSecretRef must be specified.
    types:
    - uid: ContainerServiceServicePrincipalProfile
    name: servicePrincipalProfile
- name: ManagedCluster
  description: Managed cluster.
  kind: object
  properties:
  - isReadyOnly: true
    description: Resource Id
    types:
    - uid: string
    name: id
  - isReadyOnly: true
    description: Resource name
    types:
    - uid: string
    name: name
  - isReadyOnly: true
    description: Resource type
    types:
    - uid: string
    name: type
  - description: Resource location
    types:
    - uid: string
    name: location
  - description: Resource tags
    types:
    - isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
      uid: object
    name: tags
  - description: Properties of a managed cluster.
    types:
    - uid: ManagedClusterProperties
    name: properties
- name: ContainerServiceAgentPoolProfile
  description: Profile for the container service agent pool.
  kind: object
  properties:
  - description: Unique name of the agent pool profile in the context of the subscription and resource group.
    types:
    - uid: string
    name: name
  - description: 'Number of agents (VMs) to host docker containers. Allowed values must be in the range of 1 to 100 (inclusive). The default value is 1. '
    types:
    - uid: integer
    name: count
  - description: Size of agent VMs.
    types:
    - uid: ContainerServiceVMSizeTypes
    name: vmSize
  - description: OS Disk Size in GB to be used to specify the disk size for every machine in this master/agent pool. If you specify 0, it will apply the default osDisk size according to the vmSize specified.
    types:
    - uid: integer
    name: osDiskSizeGB
  - description: DNS prefix to be used to create the FQDN for the agent pool.
    types:
    - uid: string
    name: dnsPrefix
  - isReadyOnly: true
    description: FDQN for the agent pool.
    types:
    - uid: string
    name: fqdn
  - description: Ports number array used to expose on this agent pool. The default opened ports are different based on your choice of orchestrator.
    types:
    - uid: integer
    name: ports
  - description: Storage profile specifies what kind of storage used. Choose from StorageAccount and ManagedDisks. Leave it empty, we will choose for you based on the orchestrator choice.
    types:
    - uid: ContainerServiceStorageProfileTypes
    name: storageProfile
  - description: VNet SubnetID specifies the vnet's subnet identifier. If you specify either master VNet Subnet, or agent VNet Subnet, you need to specify both. And they have to be in the same VNet.
    types:
    - uid: string
    name: vnetSubnetID
  - description: OsType to be used to specify os type. Choose from Linux and Windows. Default to Linux.
    types:
    - uid: OSType
    name: osType
- name: ContainerServiceLinuxProfile
  description: Profile for Linux VMs in the container service cluster.
  kind: object
  properties:
  - description: The administrator username to use for Linux VMs.
    types:
    - uid: string
    name: adminUsername
  - description: SSH configuration for Linux-based VMs running on Azure.
    types:
    - uid: ContainerServiceSshConfiguration
    name: ssh
- name: ContainerServiceServicePrincipalProfile
  description: Information about a service principal identity for the cluster to use for manipulating Azure APIs. Either secret or keyVaultSecretRef must be specified.
  kind: object
  properties:
  - description: The ID for the service principal.
    types:
    - uid: string
    name: clientId
  - description: The secret password associated with the service principal in plain text.
    types:
    - uid: string
    name: secret
  - description: Reference to a secret stored in Azure Key Vault.
    types:
    - uid: KeyVaultSecretRef
    name: keyVaultSecretRef
- name: OSType
  description: OsType to be used to specify os type. Choose from Linux and Windows. Default to Linux.
  kind: enum
  properties:
  - types:
    - uid: string
    name: Linux
  - types:
    - uid: string
    name: Windows
- name: ContainerServiceSshConfiguration
  description: SSH configuration for Linux-based VMs running on Azure.
  kind: object
  properties:
  - description: The list of SSH public keys used to authenticate with Linux-based VMs. Only expect one key specified.
    types:
    - uid: ContainerServiceSshPublicKey
    name: publicKeys
- name: KeyVaultSecretRef
  description: Reference to a secret stored in Azure Key Vault.
  kind: object
  properties:
  - description: Key vault identifier.
    types:
    - uid: string
    name: vaultID
  - description: The secret name.
    types:
    - uid: string
    name: secretName
  - description: The secret version.
    types:
    - uid: string
    name: version
- name: ContainerServiceSshPublicKey
  description: Contains information about SSH certificate public key data.
  kind: object
  properties:
  - description: Certificate public key used to authenticate with VMs through SSH. The certificate must be in PEM format with or without headers.
    types:
    - uid: string
    name: keyData
examples:
- request:
    uri: PUT https://management.azure.com/subscriptions/subid1/resourceGroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1?api-version=2017-08-31
    requestBody: '{"location":"location1","properties":{"dnsPrefix":"dnsprefix1","agentPoolProfiles":[{"count":1,"name":"agentpool1","vmSize":"Standard_D2_v2"}],"kubernetesVersion":"1.7.7"}}'
  responses:
  - statusCode: "200"
    body: '{"id":"/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1","location":"location1","name":"mycluster1","properties":{"accessProfiles":{"clusterAdmin":{"kubeConfig":"kubeConfig1"},"clusterUser":{"kubeConfig":"kubeConfig2"}},"agentPoolProfiles":[{"count":1,"dnsPrefix":"agentpool1dnsPrefix","fqdn":"agentpool1fqdn","name":"agentpool1","osType":"Linux","ports":[1],"storageProfile":"ManagedDisks","vmSize":"Standard_D2_v2"}],"dnsPrefix":"dnsprefix1","fqdn":"dnsprefix1-123456.abc.location1.azmk8s.io","kubernetesVersion":"1.7.7","linuxProfile":{"adminUsername":"azureuser","ssh":{"publicKeys":[{"keyData":"keydata"}]}},"provisioningState":"Succeeded","servicePrincipalProfile":{"clientId":"clientid","keyVaultSecretRef":null,"secret":"secret"}},"tags":"managedcluster","type":"Microsoft.ContainerService/ManagedClusters"}'
  - statusCode: "201"
    body: '{"id":"/subscriptions/subid1/resourcegroups/rg1/providers/Microsoft.ContainerService/managedClusters/clustername1","location":"location1","name":"mycluster1","properties":{"accessProfiles":{"clusterAdmin":{"kubeConfig":"kubeConfig1"},"clusterUser":{"kubeConfig":"kubeConfig2"}},"agentPoolProfiles":[{"count":1,"dnsPrefix":"agentpool1dnsPrefix","fqdn":"agentpool1fqdn","name":"agentpool1","osType":"Linux","ports":[1],"storageProfile":"ManagedDisks","vmSize":"Standard_D2_v2"}],"dnsPrefix":"dnsprefix1","fqdn":"dnsprefix1-123456.abc.location1.azmk8s.io","kubernetesVersion":"1.7.7","linuxProfile":{"adminUsername":"azureuser","ssh":{"publicKeys":[{"keyData":"keydata"}]}},"provisioningState":"Succeeded","servicePrincipalProfile":{"clientId":"clientid","keyVaultSecretRef":null,"secret":"secret"}},"tags":"managedcluster","type":"Microsoft.ContainerService/ManagedClusters"}'
  name: Create/Update Managed Cluster
security:
- type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - description: impersonate your user account
    name: user_impersonation
name: CreateOrUpdate
uid: management.azure.com.aks.managedclusters.createorupdate
