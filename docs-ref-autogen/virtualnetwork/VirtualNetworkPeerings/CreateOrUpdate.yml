### YamlMime:RESTOperation
summary: Creates or updates a peering in the specified virtual network.
service: Virtual Networks
apiVersion: 2017-09-01
groupName: Virtual Network Peerings
consumes:
- application/json
- text/json
produces:
- application/json
- text/json
paths:
- content: PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/virtualNetworks/{virtualNetworkName}/virtualNetworkPeerings/{virtualNetworkPeeringName}?api-version=2017-09-01
uriParameters:
- in: path
  isRequired: true
  description: The subscription credentials which uniquely identify the Microsoft Azure subscription. The subscription ID forms part of the URI for every service call.
  types:
  - uid: string
  name: subscriptionId
- in: path
  isRequired: true
  description: The name of the resource group.
  types:
  - uid: string
  name: resourceGroupName
- in: path
  isRequired: true
  description: The name of the virtual network.
  types:
  - uid: string
  name: virtualNetworkName
- in: path
  isRequired: true
  description: The name of the peering.
  types:
  - uid: string
  name: virtualNetworkPeeringName
- in: query
  isRequired: true
  description: Client API version.
  types:
  - uid: string
  name: api-version
responses:
- description: Update successful. The operation returns the resulting VirtualNetworkPeering resource.
  types:
  - uid: VirtualNetworkPeering
  name: 200 OK
- description: Create successful. The operation returns the resulting VirtualNetworkPeering resource.
  types:
  - uid: VirtualNetworkPeering
  name: 201 Created
requestBody:
- parameters:
  - in: body
    isRequired: true
    description: The name of the resource that is unique within a resource group. This name can be used to access the resource.
    types:
    - uid: string
    name: name
  - in: body
    description: A unique read-only string that changes whenever the resource is updated.
    types:
    - uid: string
    name: etag
  - in: body
    description: Whether the VMs in the linked virtual network space would be able to access all the VMs in local Virtual network space.
    types:
    - uid: boolean
    name: allowVirtualNetworkAccess
  - in: body
    description: Whether the forwarded traffic from the VMs in the remote virtual network will be allowed/disallowed.
    types:
    - uid: boolean
    name: allowForwardedTraffic
  - in: body
    description: If gateway links can be used in remote virtual networking to link to this virtual network.
    types:
    - uid: boolean
    name: allowGatewayTransit
  - in: body
    description: If remote gateways can be used on this virtual network. If the flag is set to true, and allowGatewayTransit on remote peering is also true, virtual network will use gateways of remote virtual network for transit. Only one peering can have this flag set to true. This flag cannot be set if virtual network already has a gateway.
    types:
    - uid: boolean
    name: useRemoteGateways
  - in: body
    isRequired: true
    description: The reference of the remote virtual network. The remote virtual network can be in the same or different region (preview). See here to register for the preview and learn more (https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-create-peering).
    types:
    - uid: SubResource
    name: remoteVirtualNetwork
  - in: body
    description: The status of the virtual network peering. Possible values are 'Initiated', 'Connected', and 'Disconnected'.
    types:
    - uid: VirtualNetworkPeeringState
    name: peeringState
  - in: body
    description: The provisioning state of the resource.
    types:
    - uid: string
    name: provisioningState
requestHeader: []
definitions:
- name: VirtualNetworkPeeringState
  description: The status of the virtual network peering. Possible values are 'Initiated', 'Connected', and 'Disconnected'.
  kind: enum
  properties:
  - types:
    - uid: string
    name: Initiated
  - types:
    - uid: string
    name: Connected
  - types:
    - uid: string
    name: Disconnected
- name: VirtualNetworkPeering
  description: Peerings in a virtual network resource.
  kind: object
  properties:
  - description: The name of the resource that is unique within a resource group. This name can be used to access the resource.
    types:
    - uid: string
    name: name
  - description: A unique read-only string that changes whenever the resource is updated.
    types:
    - uid: string
    name: etag
  - description: Whether the VMs in the linked virtual network space would be able to access all the VMs in local Virtual network space.
    types:
    - uid: boolean
    name: allowVirtualNetworkAccess
  - description: Whether the forwarded traffic from the VMs in the remote virtual network will be allowed/disallowed.
    types:
    - uid: boolean
    name: allowForwardedTraffic
  - description: If gateway links can be used in remote virtual networking to link to this virtual network.
    types:
    - uid: boolean
    name: allowGatewayTransit
  - description: If remote gateways can be used on this virtual network. If the flag is set to true, and allowGatewayTransit on remote peering is also true, virtual network will use gateways of remote virtual network for transit. Only one peering can have this flag set to true. This flag cannot be set if virtual network already has a gateway.
    types:
    - uid: boolean
    name: useRemoteGateways
  - description: The reference of the remote virtual network. The remote virtual network can be in the same or different region (preview). See here to register for the preview and learn more (https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-create-peering).
    types:
    - uid: SubResource
    name: remoteVirtualNetwork
  - description: The status of the virtual network peering. Possible values are 'Initiated', 'Connected', and 'Disconnected'.
    types:
    - uid: VirtualNetworkPeeringState
    name: peeringState
  - description: The provisioning state of the resource.
    types:
    - uid: string
    name: provisioningState
  - isReadyOnly: true
    description: Resource ID
    types:
    - uid: string
    name: id
- name: SubResource
  description: The reference of the remote virtual network. The remote virtual network can be in the same or different region (preview). See here to register for the preview and learn more (https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-create-peering).
  kind: object
  properties:
  - description: Resource ID.
    types:
    - uid: string
    name: id
examples:
- request:
    uri: PUT https://management.azure.com/subscriptions/subid/resourceGroups/peerTest/providers/Microsoft.Network/virtualNetworks/vnet1/virtualNetworkPeerings/peer?api-version=2017-09-01
    requestBody: '{"properties":{"allowVirtualNetworkAccess":true,"allowForwardedTraffic":true,"allowGatewayTransit":false,"useRemoteGateways":false,"remoteVirtualNetwork":{"id":"/subscriptions/subid/resourceGroups/peerTest/providers/Microsoft.Network/virtualNetworks/vnet2"}}}'
  responses:
  - statusCode: "200"
    body: '{"id":"/subscriptions/subid/resourceGroups/peerTest/providers/Microsoft.Network/virtualNetworks/vnet1/virtualNetworkPeerings/peer","name":"peer","properties":{"allowVirtualNetworkAccess":true,"allowForwardedTraffic":true,"allowGatewayTransit":false,"useRemoteGateways":false,"remoteVirtualNetwork":{"id":"/subscriptions/subid/resourceGroups/peerTest/providers/Microsoft.Network/virtualNetworks/vnet2"},"peeringState":"Initiated","provisioningState":"Succeeded"}}'
  - statusCode: "201"
    body: '{"id":"/subscriptions/subid/resourceGroups/peerTest/providers/Microsoft.Network/virtualNetworks/vnet1/virtualNetworkPeerings/peer","name":"peer","properties":{"allowVirtualNetworkAccess":true,"allowForwardedTraffic":true,"allowGatewayTransit":false,"useRemoteGateways":false,"remoteVirtualNetwork":{"id":"/subscriptions/subid/resourceGroups/peerTest/providers/Microsoft.Network/virtualNetworks/vnet2"},"peeringState":"Initiated","provisioningState":"Succeeded"}}'
  name: Create peering
security:
- type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - description: impersonate your user account
    name: user_impersonation
name: CreateOrUpdate
uid: management.azure.com.virtualnetworks.virtualnetworkpeerings.createorupdate
