### YamlMime:RESTOperation
summary: 'Updates an existing ServiceDiagnosticSettingsResource. To update other fields use the CreateOrUpdate method. **WARNING**: This method will be deprecated in future releases.'
service: Monitor
apiVersion: 2016-09-01
groupName: Service Diagnostic Settings
consumes:
- application/json
produces:
- application/json
paths:
- content: PATCH https://management.azure.com/{resourceUri}/providers/microsoft.insights/diagnosticSettings/service?api-version=2016-09-01
uriParameters:
- in: path
  isRequired: true
  description: The identifier of the resource.
  types:
  - uid: string
  name: resourceUri
- in: query
  isRequired: true
  description: Client Api Version.
  types:
  - uid: string
  name: api-version
responses:
- description: Error response describing why the operation failed.
  types:
  - uid: ErrorResponse
  name: Other Status Codes
- description: An existing service diagnostics setting resource was successfully updated.
  types:
  - uid: ServiceDiagnosticSettingsResource
  name: 200 OK
requestBody:
- parameters:
  - in: body
    description: Resource tags
    types:
    - isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
      uid: object
    name: tags
  - in: body
    description: The resource ID of the storage account to which you would like to send Diagnostic Logs.
    types:
    - uid: string
    name: storageAccountId
  - in: body
    description: "The service bus rule ID of the service bus namespace in which you would like to have Event Hubs created for streaming Diagnostic Logs. The rule ID is of the format: '{service bus resource ID}/authorizationrules/{key name}'."
    types:
    - uid: string
    name: serviceBusRuleId
  - in: body
    description: The resource Id for the event hub namespace authorization rule.
    types:
    - uid: string
    name: eventHubAuthorizationRuleId
  - in: body
    description: the list of metric settings.
    types:
    - isArray: true
      uid: MetricSettings
    name: metrics
  - in: body
    description: the list of logs settings.
    types:
    - isArray: true
      uid: LogSettings
    name: logs
  - in: body
    description: 'The workspace ID (resource ID of a Log Analytics workspace) for a Log Analytics workspace to which you would like to send Diagnostic Logs. Example: /subscriptions/4b9e8510-67ab-4e9a-95a9-e2f1e570ea9c/resourceGroups/insights-integration/providers/Microsoft.OperationalInsights/workspaces/viruela2'
    types:
    - uid: string
    name: workspaceId
requestHeader: []
definitions:
- name: ErrorResponse
  description: Describes the format of Error response.
  kind: object
  properties:
  - description: Error code
    types:
    - uid: string
    name: code
  - description: Error message indicating why the operation failed.
    types:
    - uid: string
    name: message
- name: ServiceDiagnosticSettingsResource
  description: Description of a service diagnostic setting
  kind: object
  properties:
  - description: The resource ID of the storage account to which you would like to send Diagnostic Logs.
    types:
    - uid: string
    name: storageAccountId
  - description: "The service bus rule ID of the service bus namespace in which you would like to have Event Hubs created for streaming Diagnostic Logs. The rule ID is of the format: '{service bus resource ID}/authorizationrules/{key name}'."
    types:
    - uid: string
    name: serviceBusRuleId
  - description: The resource Id for the event hub namespace authorization rule.
    types:
    - uid: string
    name: eventHubAuthorizationRuleId
  - description: the list of metric settings.
    types:
    - isArray: true
      uid: MetricSettings
    name: metrics
  - description: the list of logs settings.
    types:
    - isArray: true
      uid: LogSettings
    name: logs
  - description: 'The workspace ID (resource ID of a Log Analytics workspace) for a Log Analytics workspace to which you would like to send Diagnostic Logs. Example: /subscriptions/4b9e8510-67ab-4e9a-95a9-e2f1e570ea9c/resourceGroups/insights-integration/providers/Microsoft.OperationalInsights/workspaces/viruela2'
    types:
    - uid: string
    name: workspaceId
  - isReadyOnly: true
    description: Azure resource Id
    types:
    - uid: string
    name: id
  - isReadyOnly: true
    description: Azure resource name
    types:
    - uid: string
    name: name
  - isReadyOnly: true
    description: Azure resource type
    types:
    - uid: string
    name: type
  - description: Resource location
    types:
    - uid: string
    name: location
  - description: Resource tags
    types:
    - isDictionary: true
      additionalTypes:
      - uid: string
      - uid: string
      uid: object
    name: tags
- name: MetricSettings
  description: Part of MultiTenantDiagnosticSettings. Specifies the settings for a particular metric.
  kind: object
  properties:
  - description: the timegrain of the metric in ISO8601 format.
    types:
    - uid: string
    name: timeGrain
  - description: a value indicating whether this timegrain is enabled.
    types:
    - uid: boolean
    name: enabled
  - description: the retention policy for this timegrain.
    types:
    - uid: RetentionPolicy
    name: retentionPolicy
- name: RetentionPolicy
  description: the retention policy for this timegrain.
  kind: object
  properties:
  - description: a value indicating whether the retention policy is enabled.
    types:
    - uid: boolean
    name: enabled
  - description: the number of days for the retention in days. A value of 0 will retain the events indefinitely.
    types:
    - uid: integer
    name: days
- name: LogSettings
  description: Part of MultiTenantDiagnosticSettings. Specifies the settings for a particular log.
  kind: object
  properties:
  - description: Name of a Diagnostic Log category for a resource type this setting is applied to. To obtain the list of Diagnostic Log categories for a resource, first perform a GET diagnostic settings operation.
    types:
    - uid: string
    name: category
  - description: a value indicating whether this log is enabled.
    types:
    - uid: boolean
    name: enabled
  - description: the retention policy for this log.
    types:
    - uid: RetentionPolicy
    name: retentionPolicy
examples:
- request:
    uri: PATCH https://management.azure.com//subscriptions/1a66ce04-b633-4a0b-b2bc-a912ec8986a6/resourcegroups/viruela1/providers/microsoft.logic/workflows/viruela6/providers/microsoft.insights/diagnosticSettings/service?api-version=2016-09-01
    requestBody: '{"tags":null,"properties":{"storageAccountId":"/subscriptions/df602c9c-7aa0-407d-a6fb-eb20c8bd1192/resourceGroups/apptest/providers/Microsoft.Storage/storageAccounts/appteststorage1","serviceBusRuleId":"/subscriptions/b67f7fec-69fc-4974-9099-a26bd6ffeda3/resourceGroups/andy1101/providers/Microsoft.EventHub/namespaces/andy1101/authorizationrules/RootManageSharedAccessKey","workspaceId":"","eventHubAuthorizationRuleId":"/subscriptions/1a66ce04-b633-4a0b-b2bc-a912ec8986a6/resourceGroups/montest/providers/microsoft.eventhub/namespaces/mynamespace/eventhubs/myeventhub/authorizationrules/myrule","metrics":[{"timeGrain":"PT1M","enabled":true,"retentionPolicy":{"enabled":false,"days":3}}],"logs":[{"category":"WorkflowRuntime","enabled":true,"retentionPolicy":{"enabled":false,"days":5}}]}}'
  responses:
  - statusCode: "200"
    body: '{"id":"/subscriptions/1a66ce04-b633-4a0b-b2bc-a912ec8986a6/resourcegroups/viruela1/providers/microsoft.logic/workflows/viruela6/diagnosticSettings/service","type":"","name":"service","location":"","tags":null,"properties":{"storageAccountId":"/subscriptions/df602c9c-7aa0-407d-a6fb-eb20c8bd1192/resourceGroups/apptest/providers/Microsoft.Storage/storageAccounts/appteststorage1","serviceBusRuleId":"/subscriptions/b67f7fec-69fc-4974-9099-a26bd6ffeda3/resourceGroups/andy1101/providers/Microsoft.EventHub/namespaces/andy1101/authorizationrules/RootManageSharedAccessKey","workspaceId":"","eventHubAuthorizationRuleId":"/subscriptions/1a66ce04-b633-4a0b-b2bc-a912ec8986a6/resourceGroups/montest/providers/microsoft.eventhub/namespaces/mynamespace/eventhubs/myeventhub/authorizationrules/myrule","metrics":[{"timeGrain":"PT1M","enabled":true,"retentionPolicy":{"enabled":false,"days":3}}],"logs":[{"category":"WorkflowRuntime","enabled":true,"retentionPolicy":{"enabled":false,"days":5}}]}}'
  name: Update a service diagnostic setting
security:
- type: oauth2
  description: Azure Active Directory OAuth2 Flow
  flow: implicit
  authorizationUrl: https://login.microsoftonline.com/common/oauth2/authorize
  scopes:
  - description: impersonate your user account
    name: user_impersonation
name: Update
uid: management.azure.com.monitor.servicediagnosticsettings.update
