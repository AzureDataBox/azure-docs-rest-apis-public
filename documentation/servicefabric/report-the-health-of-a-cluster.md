---
title: "Report the health of a cluster"
ms.custom: ""
ms.date: "2016-03-30"
ms.prod: "azure"
ms.reviewer: ""
ms.service: "service-fabric"
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "reference"
applies_to: 
  - "Azure"
  - "Windows 10"
  - "Windows 8"
  - "Windows 8.1"
  - "Windows Server 2012 R2"
dev_langs: 
  - "CSharp"
helpviewer_keywords: 
  - "Service Fabric REST API Reference"
ms.assetid: 4714422d-236d-4400-87b8-5ba369d014ba
caps.latest.revision: 12
author: "rwike77"
ms.author: "ryanwi"
manager: "timlt"
translation.priority.mt: 
  - "de-de"
  - "es-es"
  - "fr-fr"
  - "it-it"
  - "ja-jp"
  - "ko-kr"
  - "pt-br"
  - "ru-ru"
  - "zh-cn"
  - "zh-tw"
---
# Report the health of a cluster
Reports the health state on the Service Fabric cluster.  
  
## Request  
 See [Cluster](../ServiceFabricREST/cluster.md) for headers and parameters that are used by all requests related to clusters.  
  
|Method|Request URI|  
|------------|-----------------|  
|POST|The following URI is used to send a cluster health report:<br /><br /> `<URI>/$/ReportClusterHealth?api-version={api-version}`|  
  
```  
{  
    "SourceId": "RestClient",  
    "Property": "State",  
    "HealthState": 3,  
    "Description": "Sample health state description of application health.",  
    "TimeToLiveInMilliSeconds": "0",  
    "SequenceNumber": "0",  
    "RemoveWhenExpired": true  
}  
```  
  
|Element name|Required|Type|Description|  
|------------------|--------------|----------|-----------------|  
|SourceId|Yes|String|The source ID of the health report.|  
|Property|Yes|String|The property being reported.|  
|HealthState|Yes|HealthState enumerated number|The health state.<br /><br /> Possible values are:<br /><br /> -   Invalid - Indicates an invalid health state. All Service Fabric enumerations have the invalid type. The value is zero.<br />-   Ok - Indicates the health state is okay. The value is 1.<br />-   Warning - Indicates the health status is at a warning level. The value is 2.<br />-   Indicated the health status is at an error level. The value is 3.<br />-   Unknown - Indicates an unknown health status. The value is 65535.|  
|Description|No|String|The health state description. The maximum string length for the description is 4096 characters.|  
|TimeToLiveInMilliSeconds|No|String|The time for this health report to be valid in milliseconds. If not specified, time to live defaults to infinite value. To explicitly set Infinite time to live, use value “922337203685477”.|  
|SequenceNumber|No|String|The sequence number for this health report as a numeric string. If not specified, a sequence number is auto-generated by the health client.|  
|RemoveWhenExpired|No|Boolean|Value of `true` to remove the health report after the time to live expires; `false` to keep the health event after the time to live expires. If not specified, the default is `false`.|  
  
## Response  
 A successful operation will return 200 OK. For information on error codes, see [Status and Error Codes](../ServiceFabricREST/status-and-error-codes1.md).  
  
## Examples  
  
```  
/// <summary>  
/// Class similar to HealthInformation. Designed for use with JavaScriptSerializer.  
/// </summary>  
public class HealthInformation2  
{  
    public string SourceId { get; set; }  
    public string Property { get; set; }  
    public HealthState HealthState { get; set; }  
    public string Description { get; set; }  
    public string TimeToLiveInMilliSeconds { get; set; }  
    public string SequenceNumber { get; set; }  
    public bool RemoveWhenExpired { get; set; }  
}  
  
/// <summary>  
/// Reports the health of the cluster.  
/// </summary>  
/// <param name="clusterUri">The URI of the cluster.</param>  
/// <returns>Returns true if successful; otherwise returns false.</returns>  
public static bool ReportClusterHealth(Uri clusterUri)  
{  
    // Stores the response status code.  
    HttpStatusCode statusCode;  
  
    // Create the request and add URL parameters.  
    Uri requestUri = new Uri(clusterUri, string.Format("/$/ReportClusterHealth?api-version={0}",  
        "1.0"));                // api-version  
  
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(requestUri);  
    request.ContentType = "text/json";  
    request.Method = "POST";  
  
    // Create the Health Policy.  
    HealthInformation2 healthInformation = new HealthInformation2()  
    {  
        SourceId = "RestClient",  
        Property = "State",  
        HealthState = HealthState.Error,  
        Description = "Sample health state description of cluster health.",  
        TimeToLiveInMilliSeconds = "0",  
        SequenceNumber = "0",  
        RemoveWhenExpired = true  
    };  
  
    // Serialize the health policy.  
    JavaScriptSerializer jss = new JavaScriptSerializer();  
    string requestBody = jss.Serialize(healthInformation);  
  
    // Create the byte array that will become the request body.  
    byte[] requestBodyBytes = Encoding.UTF8.GetBytes(requestBody);  
    request.ContentLength = requestBodyBytes.Length;  
  
    // Create the request body.  
    try  
    {  
        using (Stream requestStream = request.GetRequestStream())  
        {  
            requestStream.Write(requestBodyBytes, 0, requestBodyBytes.Length);  
            requestStream.Close();  
  
            // Execute the request and obtain the response.  
            using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())  
            {  
                statusCode = response.StatusCode;  
            }  
        }  
    }  
    catch (WebException e)  
    {  
        // If there is a web exception, display the error message.  
        Console.WriteLine("Error reporting cluster health:");  
        Console.WriteLine(e.Message);  
        if (e.InnerException != null)  
            Console.WriteLine(e.InnerException.Message);  
        return false;  
    }  
    catch (Exception e)  
    {  
        // If there is another kind of exception, throw it.  
        throw (e);  
    }  
  
    Console.WriteLine("Report Cluster Health response status = " + statusCode.ToString());  
    return true;  
}  
  
/* This code produces output similar to the following:  
  
Report Cluster Health response status = OK  
*/  
  
/* JSON request string (formatted):   
{  
    "SourceId": "RestClient",  
    "Property": "State",  
    "HealthState": 3,  
    "Description": "Sample health state description of cluster health.",  
    "TimeToLiveInMilliSeconds": "0",  
    "SequenceNumber": "0",  
    "RemoveWhenExpired": true  
}  
*/  
```